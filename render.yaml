services:
  # --- Backend (Node/Express) ---
  - type: web
    name: cv-backend
    runtime: node
    plan: free
    branch: master          # cambia a main si tu rama principal es main
    rootDir: backend
    buildCommand: npm ci
    startCommand: npm start  # asegúrate de tener "start": "node src/app.js" en backend/package.json
    envVars:
      - key: NODE_VERSION
        value: 18
      # - key: MONGODB_URI
      #   sync: false
      # - key: JWT_SECRET
      #   sync: false

  # --- Frontend (Vite - sitio estático) ---
  - type: web
    name: cv-frontend
    runtime: static
    plan: free
    branch: master          # cambia a main si corresponde
    rootDir: frontend
    buildCommand: npm ci && npm run build
    staticPublishPath: dist
    routes:
      - type: rewrite
        source: /*
        destination: /index.html
    envVars:
      # Si tu frontend consume la API, definí esto en el panel cuando el backend esté online:
      # - key: VITE_API_URL
      #   value: https://cv-backend.onrender.com
